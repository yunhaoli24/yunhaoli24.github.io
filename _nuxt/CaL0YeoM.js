import{X as e,a2 as t,a5 as n,a7 as r,aB as i,aH as a,aS as o,aX as s,ag as c,ah as l,ai as u,ak as d,c as f,d as p}from"#entry";import{c as m,g as h}from"./DC4hiPh_.js";import{b as g}from"./C326c92g.js";import{b as _,d as v}from"./DI4EpC9N.js";function y(e,t){return t.reduce((t,n)=>{let r=b(e,n);return r!==void 0&&(t[n]=r),t},{})}function b(e,t){return t.split(`.`).reduce((e,t)=>e&&e[t],e)}const x=`default`,S=/^@|^v-on:/,C=/^:|^v-bind:/,w=/^v-model/,T=[`select`,`textarea`,`input`],E=[`math`,`svg`],D=Object.fromEntries(`p.a.blockquote.code.pre.code.em.h1.h2.h3.h4.h5.h6.hr.img.ul.ol.li.strong.table.thead.tbody.td.th.tr.script`.split(`.`).map(e=>[e,`prose-${e}`])),O=l({name:`MDCRenderer`,props:{body:{type:Object,required:!0},data:{type:Object,default:()=>({})},class:{type:[String,Object],default:void 0},tag:{type:[String,Boolean],default:void 0},prose:{type:Boolean,default:void 0},components:{type:Object,default:()=>({})},unwrap:{type:[Boolean,String],default:!1}},async setup(e){let t=u()?.appContext?.app,n=t?.$nuxt,i=n?.$route||n?._route,{mdc:c}=n?.$config?.public||{},l=r(()=>({...c?.components?.prose&&e.prose!==!1?D:{},...c?.components?.map||{},...s(e.data?.mdc?.components||{}),...e.components})),d=r(()=>{let t=(e.body?.children||[]).map(e=>e.tag||e.type).filter(e=>!g.includes(e));return Array.from(new Set(t)).sort().join(`.`)}),f=o({...e.data});a(()=>e.data,e=>{Object.assign(f,e)}),await U(e.body,{tags:l.value});function p(e,t){let n=e.split(`.`).length-1;return e.split(`.`).reduce((e,r,i)=>i==n&&e?(e[r]=t,e[r]):typeof e==`object`?e[r]:void 0,f)}return{tags:l,contentKey:d,route:i,runtimeData:f,updateRuntimeData:p}},render(e){let{tags:t,tag:n,body:r,data:i,contentKey:a,route:o,unwrap:s,runtimeData:c,updateRuntimeData:l}=e;if(!r)return null;let u={...i,tags:t,$route:o,runtimeData:c,updateRuntimeData:l},f=n===!1?void 0:L(n||u.component?.name||u.component||`div`);return f?d(f,{...u.component?.props,class:e.class,...this.$attrs,key:a},{default:p}):p?.();function p(){let e=A(r,d,{documentMeta:u,parentScope:u,resolveComponent:L});return e?.default?s?m(e.default(),typeof s==`string`?s.split(` `):[`*`]):e.default():null}}});function k(e,r,i,a){let{documentMeta:o,parentScope:s,resolveComponent:c}=i;if(e.type===`text`)return r(n,e.value);if(e.type===`comment`)return r(t,null,e.value);let l=e.tag,u=W(e,o.tags);if(e.tag===`binding`)return j(e,r,o,s);let d=V(u)?e=>e:c;if(u===`script`)return r(`pre`,{class:`script-to-pre`},`<script>
`+h(e)+`
<\/script>`);let f=d(u);typeof f==`object`&&(f.tag=l);let p=M(e,o);return a&&(p.key=a),r(f,p,A(e,r,{documentMeta:o,parentScope:{...s,...p},resolveComponent:d}))}function A(e,t,n){let{documentMeta:r,parentScope:i,resolveComponent:a}=n,o=e.children||[],s=o.reduce((e,t)=>{if(!B(t))return e[x].children.push(t),e;let n=z(t);return e[n]=e[n]||{props:{},children:[]},t.type===`element`&&(e[n].props=t.props,e[n].children.push(...t.children||[])),e},{[x]:{props:{},children:[]}}),c=Object.entries(s).reduce((e,[n,{props:o,children:s}])=>(s.length&&(e[n]=(e={})=>{let n=y(e,Object.keys(o||{})),c=s.map((e,o)=>k(e,t,{documentMeta:r,parentScope:{...i,...n},resolveComponent:a},String(e.props?.key||o)));return o?.unwrap&&(c=m(c,o.unwrap)),H(c)}),e),{});return c}function j(e,t,r,i={}){let a={...r.runtimeData,...i,$document:r,$doc:r},o=/\.|\[(\d+)\]/,s=e.props?.value.trim().split(o).filter(Boolean),c=s.reduce((e,t)=>{if(e&&t in e)return typeof e[t]==`function`?e[t]():e[t]},a),l=e.props?.defaultValue;return t(n,c??l??``)}function M(e,t){let{tag:n=``,props:r={}}=e;return Object.keys(r).reduce(function(e,i){if(i===`__ignoreMap`)return e;let a=r[i];if(w.test(i))return N(i,a,e,t,{native:T.includes(n)});if(i===`v-bind`)return P(i,a,e,t);if(S.test(i))return F(i,a,e,t);if(C.test(i))return I(i,a,e,t);let{attribute:o}=v(_,i);return Array.isArray(a)&&a.every(e=>typeof e==`string`)?(e[o]=a.join(` `),e):(e[o]=a,e)},{})}function N(e,t,n,r,{native:i}){let a=e.match(/^v-model:([^=]+)/)?.[1]||`modelValue`,o=i?`value`:a,s=i?`onInput`:`onUpdate:${a}`;return n[o]=R(t,r.runtimeData),n[s]=e=>{r.updateRuntimeData(t,i?e.target?.value:e)},n}function P(e,t,n,r){let i=R(t,r);return n=Object.assign(n,i),n}function F(e,t,n,r){return e=e.replace(S,``),n.on=n.on||{},n.on[e]=()=>R(t,r),n}function I(e,t,n,r){return e=e.replace(C,``),n[e]=R(t,r),n}const L=e=>{if(typeof e==`string`){if(g.includes(e))return e;let t=i(p(e),!1);return!e||t?.name===`AsyncComponentWrapper`||typeof t==`string`?t:`setup`in t?c(()=>new Promise(e=>e(t))):t}return e};function R(t,n){let r=t.split(`.`).reduce((e,t)=>typeof e==`object`?e[t]:void 0,n);return r===void 0?e(t):r}function z(e){let t=``;for(let n of Object.keys(e.props||{})){if(!n.startsWith(`#`)&&!n.startsWith(`v-slot:`))continue;t=n.split(/[:#]/,2)[1];break}return t||x}function B(e){return e.tag===`template`}function V(e){return E.includes(e)}function H(e){let t=[];for(let r of e){let e=t[t.length-1];r.type===n&&e?.type===n?e.children+=r.children:t.push(r)}return t}async function U(e,t){if(!e)return;let n=Array.from(new Set(r(e,t)));await Promise.all(n.map(async e=>{if(e?.render||e?.ssrRender||e?.__ssrInlineRender)return;let t=L(e);t?.__asyncLoader&&!t.__asyncResolved&&await t.__asyncLoader()}));function r(e,t){let n=e.tag;if(e.type===`text`||n===`binding`||e.type===`comment`)return[];let i=W(e,t.tags);if(V(i))return[];let a=[];e.type!==`root`&&!g.includes(i)&&a.push(i);for(let n of e.children||[])a.push(...r(n,t));return a}}function W(e,t){let n=e.tag;return!n||e.props?.__ignoreMap!==void 0?n:t[n]||t[p(n)]||t[f(e.tag)]||n}var G=Object.assign(O,{__name:`MDCRenderer`});export{G as b};