<!DOCTYPE html><html  lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><script type="importmap">{"imports":{"#entry":"/_nuxt/CGCySwaJ.js"}}</script><title>Yunhao Li - blog-cuda-docker</title><link rel="stylesheet" href="/_nuxt/entry.Co2T8a3r.css" crossorigin><link rel="stylesheet" href="/_nuxt/default.CQL9LdGM.css" crossorigin><link rel="stylesheet" href="/_nuxt/style.BHgrWUtD.css" crossorigin><link rel="stylesheet" href="/_nuxt/style.CKTNkHcw.css" crossorigin><link rel="stylesheet" href="/_nuxt/style.BFI6Bq-W.css" crossorigin><link rel="stylesheet" href="/_nuxt/app.BydcJ6zn.css" crossorigin><link rel="stylesheet" href="/_nuxt/style.DMa4Mjx6.css" crossorigin><link rel="stylesheet" href="/_nuxt/_...BepM8zsa.css" crossorigin><style>:where(.i-catppuccin\:bash){display:inline-block;width:1em;height:1em;background-repeat:no-repeat;background-size:100% 100%;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' width='16' height='16'%3E%3Cg fill='none' stroke='%23a6da95' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M2 15.5c-.7 0-1.5-.8-1.5-1.5V5c0-.7.8-1.5 1.5-1.5h9c.7 0 1.5.8 1.5 1.5v9c0 .7-.8 1.5-1.5 1.5z'/%3E%3Cpath d='m1.2 3.8l3.04-2.5S5.17.5 5.7.5h8.4c.66 0 1.4.73 1.4 1.4v7.73a2.7 2.7 0 0 1-.7 1.75l-2.68 3.51'/%3E%3Cpath d='M6 8.75c0-.69-.54-1.25-1.2-1.25h-.6c-.66 0-1.2.56-1.2 1.25S3.54 10 4.2 10h.6c.66 0 1.2.56 1.2 1.25s-.54 1.25-1.2 1.25h-.6c-.66 0-1.2-.56-1.2-1.25M4.5 6.5v1m0 5v1'/%3E%3C/g%3E%3C/svg%3E")}:where(.i-catppuccin\:docker){display:inline-block;width:1em;height:1em;background-repeat:no-repeat;background-size:100% 100%;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' width='16' height='16'%3E%3Cpath fill='none' stroke='%238aadf4' stroke-linecap='round' stroke-linejoin='round' d='M.5 8.5H11l.75-.5a5.35 5.35 0 0 1 0-3.5c1 .6 1 1.88 1.74 2c.77-.09 1.23.01 2 .52c0 0-.97 1.77-2.5 1.98c-1.93 3.65-4.5 5.5-6.98 5.5C0 14.5.5 8.5.5 8.5m1 0v-2m0 0h8m-6 2v-4m0 0h4m-2-2h2m-2 6v-6m2 6v-6m2 6v-2'/%3E%3C/svg%3E")}:where(.i-hugeicons\:search-01){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m17 17l4 4m-2-10a8 8 0 1 0-16 0a8 8 0 0 0 16 0'/%3E%3C/svg%3E")}:where(.i-material-symbols\:light-mode){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='black' d='M12 17q-2.075 0-3.537-1.463T7 12t1.463-3.537T12 7t3.538 1.463T17 12t-1.463 3.538T12 17m-7-4H1v-2h4zm18 0h-4v-2h4zM11 5V1h2v4zm0 18v-4h2v4zM6.4 7.75L3.875 5.325L5.3 3.85l2.4 2.5zm12.3 12.4l-2.425-2.525L17.6 16.25l2.525 2.425zM16.25 6.4l2.425-2.525L20.15 5.3l-2.5 2.4zM3.85 18.7l2.525-2.425L7.75 17.6l-2.425 2.525z'/%3E%3C/svg%3E")}:where(.i-tabler\:copy){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cg fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2'%3E%3Cpath d='M7 9.667A2.667 2.667 0 0 1 9.667 7h8.666A2.667 2.667 0 0 1 21 9.667v8.666A2.667 2.667 0 0 1 18.333 21H9.667A2.667 2.667 0 0 1 7 18.333z'/%3E%3Cpath d='M4.012 16.737A2 2 0 0 1 3 15V5c0-1.1.9-2 2-2h10c.75 0 1.158.385 1.5 1'/%3E%3C/g%3E%3C/svg%3E")}</style><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CGCySwaJ.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/U725BVvE.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DpYxfLlx.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CfYLUF7N.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dae_vkcH.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/B6Qydxqy.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BZ0AlPGr.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DzvNXTjd.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BHonhOiW.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DP3yFTrx.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DShArktz.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/5oSC9XW9.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CaL0YeoM.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/C326c92g.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DC4hiPh_.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DI4EpC9N.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BvQhSLs_.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DPgmLUbP.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CEBcBon2.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DXliQJhi.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/tnXUFGmR.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CCTUZIBE.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dy8KJQxI.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BYWkKT81.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Bo69fATk.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/C_oamPMK.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DR2ko6O7.js"><link rel="preload" as="fetch" fetchpriority="low" crossorigin="anonymous" href="/_nuxt/builds/meta/bb85fc13-cd4e-4b6a-a07d-f81f8017cc1b.json"><link rel="prefetch" as="style" crossorigin href="/_nuxt/mobile.CWbb_b09.css"><link rel="prefetch" as="script" crossorigin href="/_nuxt/wZdYlb_V.js"><link rel="prefetch" as="style" crossorigin href="/_nuxt/error-404.BQMs95bW.css"><link rel="prefetch" as="script" crossorigin href="/_nuxt/BDamjP1D.js"><link rel="prefetch" as="style" crossorigin href="/_nuxt/error-500.xnE7cslF.css"><link rel="prefetch" as="script" crossorigin href="/_nuxt/CscgXzQx.js"><link rel="icon" type="image/x-icon" href="/favicon.ico"><meta name="title" content="Yunhao Li"><meta name="description" content="The blog of Yunhao Li, a passionate researcher who love to use programming skills and creativity to solve problems."><meta name="og:title" content="Yunhao Li"><meta name="og:image" content="https://yunhaoli.top/profile.JPG"><meta name="og:url" content="https://yunhaoli.top"><meta name="twitter:title" content="Yunhao Li"><meta name="twitter:image" content="https://yunhaoli.top/og_image.jpeg"><meta name="twitter:creator" content="@YunhaoLi"><meta property="og:type" content="website"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><script type="module" src="/_nuxt/CGCySwaJ.js" crossorigin></script><meta name="twitter:card" content="summary_large_image"><meta property="og:description" data-infer="" content="The blog of Yunhao Li, a passionate researcher who love to use programming skills and creativity to solve problems."><link rel="canonical" href="https://yunhaoli.top/blog/cuda-docker"><meta property="og:site_name" content="Yunhao Li"><script id="unhead:payload" type="application/json">{"title":"Yunhao Li"}</script><script>"use strict";(()=>{const t=window,e=document.documentElement,c=["dark","light"],n=getStorageValue("localStorage","nuxt-color-mode")||"system";let i=n==="system"?u():n;const r=e.getAttribute("data-color-mode-forced");r&&(i=r),l(i),t["__NUXT_COLOR_MODE__"]={preference:n,value:i,getColorScheme:u,addColorScheme:l,removeColorScheme:d};function l(o){const s=""+o+"",a="";e.classList?e.classList.add(s):e.className+=" "+s,a&&e.setAttribute("data-"+a,o)}function d(o){const s=""+o+"",a="";e.classList?e.classList.remove(s):e.className=e.className.replace(new RegExp(s,"g"),""),a&&e.removeAttribute("data-"+a)}function f(o){return t.matchMedia("(prefers-color-scheme"+o+")")}function u(){if(t.matchMedia&&f("").media!=="not all"){for(const o of c)if(f(":"+o).matches)return o}return"light"}})();function getStorageValue(t,e){switch(t){case"localStorage":return window.localStorage.getItem(e);case"sessionStorage":return window.sessionStorage.getItem(e);case"cookie":return getCookie(e);default:return null}}function getCookie(t){const c=("; "+window.document.cookie).split("; "+t+"=");if(c.length===2)return c.pop()?.split(";").shift()}</script></head><body><div id="__nuxt"><div><div></div><div data-v-5dfd6732><div data-v-5dfd6732><section class="el-container is-vertical" data-v-5dfd6732><!--[--><header class="el-header h-60px" style="" data-v-5dfd6732><!--[--><ul role="menubar" style="--el-menu-level:0;" class="el-menu el-menu--horizontal" data-v-5dfd6732 data-v-1e26f161><li class="el-menu-item" role="menuitem" tabindex="-1" data-v-1e26f161><!--[--><!--[--> Home <!--]--><!--[--><!--]--><!--]--></li><li class="el-menu-item" role="menuitem" tabindex="-1" data-v-1e26f161><!--[--><!--[--> Blog <!--]--><!--[--><!--]--><!--]--></li><div class="flex-grow" data-v-1e26f161></div><li class="el-menu-item is-active" role="menuitem" tabindex="-1" data-v-1e26f161 data-v-1e26f161><!--[--><!--[--><div class="flex items-center" data-v-1e26f161 data-v-d7fec013><button ariadisabled="false" type="button" class="el-button is-round tracking-wider font-medium shadow-black/8 shadow-sm transition-all duration-300 hover:shadow-black/12 hover:shadow-md hover:scale-105" style="" data-v-d7fec013><i class="el-icon" style=""><!--[--><span class="iconify i-hugeicons:search-01" aria-hidden="true" style="" data-v-1e26f161></span><!--]--></i><span class=""><!--[--> Search <!--]--></span></button><!--[--><div class="el-overlay" style="z-index:2001;display:none;"><!--[--><div role="dialog" aria-modal="true" aria-labelledby="el-id-1024-0" aria-describedby="el-id-1024-1" class="el-overlay-dialog" style=""><!--[--><!--]--></div><!--]--></div><!--]--></div><!--]--><!--[--><!--]--><!--]--></li><li class="el-menu-item is-active" role="menuitem" tabindex="-1" data-v-1e26f161><!--[--><!--[--><div class="el-switch dark:[--el-switch-on-color] light:[--el-switch-off-color]" data-v-1e26f161><input class="el-switch__input" type="checkbox" role="switch" aria-checked="false" aria-disabled="false" name true-value="true" false-value="false"><!--v-if--><span class="el-switch__core" style="width:;"><div class="el-switch__inner"><!--v-if--></div><div class="el-switch__action"><!--[--><i class="el-icon" style=""><!--[--><span class="iconify i-material-symbols:light-mode" aria-hidden="true" style="" data-v-5dfd6732></span><!--]--></i><!--]--></div></span><!--v-if--></div><!--]--><!--[--><!--]--><!--]--></li></ul><!--]--></header><main class="el-main h-[calc(100vh-60px)]" data-v-5dfd6732><!--[--><div class="el-scrollbar" data-v-5dfd6732><div class="el-scrollbar__wrap el-scrollbar__wrap--hidden-default" style=""><div class="el-scrollbar__view" style=""><!--[--><div class="el-col el-col-18 el-col-offset-3" style="" data-v-5dfd6732><!--[--><!--[--><!--[--><div><div class="m-r-1 p-4 h-[80vh] w-[9vw] translate-y-30 right-0 top-50 fixed overflow-y-auto"><div class="el-scrollbar"><div class="el-scrollbar__wrap el-scrollbar__wrap--hidden-default" style=""><div class="el-scrollbar__view" style=""><!--[--><div class="el-tree el-tree--highlight-current" role="tree"><!--[--><div class="el-tree-node is-expanded is-focusable" role="treeitem" tabindex="-1" aria-expanded="true" aria-checked="false" draggable="false" data-key="背景"><div class="el-tree-node__content" style="padding-left:0px;"><i class="el-icon el-tree-node__expand-icon expanded" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M384 192v640l384-320.064z"></path></svg><!--]--></i><!--v-if--><!--v-if--><!--[--><span class="el-text is-truncated el-tree-node__label" style=""><!--[-->背景<!--]--></span><!--]--></div><div class="el-tree-node__children" role="group" aria-expanded="true"><!--[--><div class="el-tree-node is-expanded is-focusable" role="treeitem" tabindex="-1" aria-expanded="true" aria-checked="false" draggable="false" data-key="需求"><div class="el-tree-node__content" style="padding-left:18px;"><i class="el-icon el-tree-node__expand-icon is-leaf" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M384 192v640l384-320.064z"></path></svg><!--]--></i><!--v-if--><!--v-if--><!--[--><span class="el-text is-truncated el-tree-node__label" style=""><!--[-->需求<!--]--></span><!--]--></div><div class="el-tree-node__children" role="group" aria-expanded="true"><!--[--><!--]--></div></div><!--]--></div></div><div class="el-tree-node is-expanded is-focusable" role="treeitem" tabindex="-1" aria-expanded="true" aria-checked="false" draggable="false" data-key="安装"><div class="el-tree-node__content" style="padding-left:0px;"><i class="el-icon el-tree-node__expand-icon expanded" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M384 192v640l384-320.064z"></path></svg><!--]--></i><!--v-if--><!--v-if--><!--[--><span class="el-text is-truncated el-tree-node__label" style=""><!--[-->安装<!--]--></span><!--]--></div><div class="el-tree-node__children" role="group" aria-expanded="true"><!--[--><div class="el-tree-node is-expanded is-focusable" role="treeitem" tabindex="-1" aria-expanded="true" aria-checked="false" draggable="false" data-key="宿主机安装-cuda-驱动"><div class="el-tree-node__content" style="padding-left:18px;"><i class="el-icon el-tree-node__expand-icon is-leaf" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M384 192v640l384-320.064z"></path></svg><!--]--></i><!--v-if--><!--v-if--><!--[--><span class="el-text is-truncated el-tree-node__label" style=""><!--[-->宿主机安装 CUDA 驱动<!--]--></span><!--]--></div><div class="el-tree-node__children" role="group" aria-expanded="true"><!--[--><!--]--></div></div><div class="el-tree-node is-expanded is-focusable" role="treeitem" tabindex="-1" aria-expanded="true" aria-checked="false" draggable="false" data-key="宿主机安装-nvidia-容器工具包"><div class="el-tree-node__content" style="padding-left:18px;"><i class="el-icon el-tree-node__expand-icon is-leaf" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M384 192v640l384-320.064z"></path></svg><!--]--></i><!--v-if--><!--v-if--><!--[--><span class="el-text is-truncated el-tree-node__label" style=""><!--[-->宿主机安装 NVIDIA 容器工具包<!--]--></span><!--]--></div><div class="el-tree-node__children" role="group" aria-expanded="true"><!--[--><!--]--></div></div><!--]--></div></div><div class="el-tree-node is-expanded is-focusable" role="treeitem" tabindex="-1" aria-expanded="true" aria-checked="false" draggable="false" data-key="构建容器"><div class="el-tree-node__content" style="padding-left:0px;"><i class="el-icon el-tree-node__expand-icon expanded" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M384 192v640l384-320.064z"></path></svg><!--]--></i><!--v-if--><!--v-if--><!--[--><span class="el-text is-truncated el-tree-node__label" style=""><!--[-->构建容器<!--]--></span><!--]--></div><div class="el-tree-node__children" role="group" aria-expanded="true"><!--[--><div class="el-tree-node is-expanded is-focusable" role="treeitem" tabindex="-1" aria-expanded="true" aria-checked="false" draggable="false" data-key="编写-dockerfile"><div class="el-tree-node__content" style="padding-left:18px;"><i class="el-icon el-tree-node__expand-icon is-leaf" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M384 192v640l384-320.064z"></path></svg><!--]--></i><!--v-if--><!--v-if--><!--[--><span class="el-text is-truncated el-tree-node__label" style=""><!--[-->编写 Dockerfile<!--]--></span><!--]--></div><div class="el-tree-node__children" role="group" aria-expanded="true"><!--[--><!--]--></div></div><div class="el-tree-node is-expanded is-focusable" role="treeitem" tabindex="-1" aria-expanded="true" aria-checked="false" draggable="false" data-key="build容器"><div class="el-tree-node__content" style="padding-left:18px;"><i class="el-icon el-tree-node__expand-icon is-leaf" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M384 192v640l384-320.064z"></path></svg><!--]--></i><!--v-if--><!--v-if--><!--[--><span class="el-text is-truncated el-tree-node__label" style=""><!--[-->build容器<!--]--></span><!--]--></div><div class="el-tree-node__children" role="group" aria-expanded="true"><!--[--><!--]--></div></div><div class="el-tree-node is-expanded is-focusable" role="treeitem" tabindex="-1" aria-expanded="true" aria-checked="false" draggable="false" data-key="运行容器"><div class="el-tree-node__content" style="padding-left:18px;"><i class="el-icon el-tree-node__expand-icon is-leaf" style=""><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024"><path fill="currentColor" d="M384 192v640l384-320.064z"></path></svg><!--]--></i><!--v-if--><!--v-if--><!--[--><span class="el-text is-truncated el-tree-node__label" style=""><!--[-->运行容器<!--]--></span><!--]--></div><div class="el-tree-node__children" role="group" aria-expanded="true"><!--[--><!--]--></div></div><!--]--></div></div><!--]--><!--v-if--><div class="el-tree__drop-indicator" style="display:none;"></div></div><!--]--></div></div><!--[--><div class="el-scrollbar__bar is-horizontal" style="display:none;"><div class="el-scrollbar__thumb" style="width:;transform:translateX(0%);"></div></div><div class="el-scrollbar__bar is-vertical" style="display:none;"><div class="el-scrollbar__thumb" style="height:;transform:translateY(0%);"></div></div><!--]--></div></div><div><section><h1 class="text-4xl"><!--[-->构建PyTorch Docker镜像<!--]--></h1></section><h2 id="背景"><!--[-->背景<!--]--></h2><p><!--[-->实验室服务器的内核版本较旧，某个项目需要升级内核，但由于服务器上运行着大量关键服务，直接升级可能存在风险。<!--]--></p><p><!--[-->因此，计划通过 Docker 构建一个包含 CUDA 和 Python 环境的镜像，通过 SSH 连接到容器中进行深度学习模型训练。<!--]--></p><h3 id="需求"><!--[-->需求<!--]--></h3><p><!--[-->CUDA 是深度学习模型训练的核心依赖，必须包含在镜像中。此外，SSH 服务也需要配置以支持远程访问。为了简化环境管理，计划将 Python 环境及常用依赖包一并打包到镜像中。<!--]--></p><p><!--[-->未来，任何需要进行深度学习模型训练的用户，只需启动一个容器并映射相应端口，即可获得完整的训练环境。<!--]--></p><h2 id="安装"><!--[-->安装<!--]--></h2><h3 id="宿主机安装-cuda-驱动"><!--[-->宿主机安装 CUDA 驱动<!--]--></h3><p><!--[-->以下命令用于安装 NVIDIA 驱动程序（可根据需求选择其他版本）：<!--]--></p><div class="flex flex-col dark:bg-gray-800 light:bg-gray-100" style=""><div class="rounded-t flex h-10 items-center"><span class="iconify i-catppuccin:bash ml-3" aria-hidden="true" style=""></span><!----><button ariadisabled="false" type="button" class="el-button ml-auto mr-3 rounded flex gap-1 transition-all" style=""><!--v-if--><span class=""><!--[--><span style="display:none;">Copied </span><span class="iconify i-tabler:copy" aria-hidden="true" style=""></span><!--]--></span></button></div><pre class="language-shell shiki shiki-themes github-light github-dark monokai rounded-b px-4 rounded-md whitespace-pre-wrap break-words overflow-x-auto overflow-x-auto"><!--[--><code><span class="line" line="1"><span class="srTi1">apt</span><span class="sstjo"> install</span><span class="s7F3e"> -y</span><span class="sstjo"> nvidia-driver-550</span><span class="s8-w5"> # 可根据实际需求更换版本
</span></span></code><!--]-->
  </pre></div><h3 id="宿主机安装-nvidia-容器工具包"><!--[-->宿主机安装 NVIDIA 容器工具包<!--]--></h3><p><!--[-->访问 <a href="https://nvidia.github.io/nvidia-container-runtime/" rel="nofollow"><!--[-->https://nvidia.github.io/nvidia-container-runtime/<!--]--></a> 查看支持的操作系统和版本，并根据对应的选项添加软件源。以下步骤适用于 Ubuntu 系统：<!--]--></p><div class="flex flex-col dark:bg-gray-800 light:bg-gray-100" style=""><div class="rounded-t flex h-10 items-center"><span class="iconify i-catppuccin:bash ml-3" aria-hidden="true" style=""></span><!----><button ariadisabled="false" type="button" class="el-button ml-auto mr-3 rounded flex gap-1 transition-all" style=""><!--v-if--><span class=""><!--[--><span style="display:none;">Copied </span><span class="iconify i-tabler:copy" aria-hidden="true" style=""></span><!--]--></span></button></div><pre class="language-shell shiki shiki-themes github-light github-dark monokai rounded-b px-4 rounded-md whitespace-pre-wrap break-words overflow-x-auto overflow-x-auto"><!--[--><code><span class="line" line="1"><span class="srTi1">curl</span><span class="s7F3e"> -fsSL</span><span class="sstjo"> https://nvidia.github.io/libnvidia-container/gpgkey</span><span class="sC2Qs"> |</span><span class="srTi1"> sudo</span><span class="sstjo"> gpg</span><span class="s7F3e"> --dearmor</span><span class="s7F3e"> -o</span><span class="sstjo"> /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg</span><span class="s7F3e"> \
</span></span><span class="line" line="2"><span class="sMOD_">  &amp;&amp; </span><span class="srTi1">curl</span><span class="s7F3e"> -s</span><span class="s7F3e"> -L</span><span class="sstjo"> https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list</span><span class="sC2Qs"> |</span><span class="s7F3e"> \
</span></span><span class="line" line="3"><span class="srTi1">    sed</span><span class="sstjo"> &#39;s#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g&#39;</span><span class="sC2Qs"> |</span><span class="s7F3e"> \
</span></span><span class="line" line="4"><span class="srTi1">    sudo</span><span class="sstjo"> tee</span><span class="sstjo"> /etc/apt/sources.list.d/nvidia-container-toolkit.list
</span></span></code><!--]-->
  </pre></div><p><!--[-->然后直接运行下面的命令就可以安装docker cuda驱动<!--]--></p><div class="flex flex-col dark:bg-gray-800 light:bg-gray-100" style=""><div class="rounded-t flex h-10 items-center"><span class="iconify i-catppuccin:bash ml-3" aria-hidden="true" style=""></span><!----><button ariadisabled="false" type="button" class="el-button ml-auto mr-3 rounded flex gap-1 transition-all" style=""><!--v-if--><span class=""><!--[--><span style="display:none;">Copied </span><span class="iconify i-tabler:copy" aria-hidden="true" style=""></span><!--]--></span></button></div><pre class="language-shell shiki shiki-themes github-light github-dark monokai rounded-b px-4 rounded-md whitespace-pre-wrap break-words overflow-x-auto overflow-x-auto"><!--[--><code><span class="line" line="1"><span class="srTi1">sudo</span><span class="sstjo"> apt-get</span><span class="sstjo"> update
</span></span><span class="line" line="2"><span class="srTi1">apt-get</span><span class="sstjo"> install</span><span class="s7F3e"> -y</span><span class="sstjo"> nvidia-container-toolkit
</span></span><span class="line" line="3"><span class="srTi1">tee</span><span class="sstjo"> /etc/docker/daemon.json</span><span class="sC2Qs"> &lt;&lt;-</span><span class="sinWB">&#39;EOF&#39;
</span></span><span class="line" line="4"><span class="sstjo">{
</span></span><span class="line" line="5"><span class="sstjo">    &quot;runtimes&quot;: {
</span></span><span class="line" line="6"><span class="sstjo">        &quot;nvidia&quot;: {
</span></span><span class="line" line="7"><span class="sstjo">            &quot;path&quot;: &quot;/usr/bin/nvidia-container-runtime&quot;,
</span></span><span class="line" line="8"><span class="sstjo">            &quot;runtimeArgs&quot;: []
</span></span><span class="line" line="9"><span class="sstjo">        }
</span></span><span class="line" line="10"><span class="sstjo">    },
</span></span><span class="line" line="11"><span class="sstjo">    &quot;default-runtime&quot;: &quot;nvidia&quot;
</span></span><span class="line" line="12"><span class="sstjo">}
</span></span><span class="line" line="13"><span class="sinWB">EOF
</span></span><span class="line" line="14"><span class="srTi1">sudo</span><span class="sstjo"> systemctl</span><span class="sstjo"> restart</span><span class="sstjo"> docker
</span></span><span class="line" line="15"><span class="srTi1">sudo</span><span class="sstjo"> nvidia-ctk</span><span class="sstjo"> runtime</span><span class="sstjo"> configure</span><span class="s7F3e"> --runtime=containerd
</span></span></code><!--]-->
  </pre></div><p><!--[-->进行测试，如果能成功出现显卡信息就可以了<!--]--></p><div class="flex flex-col dark:bg-gray-800 light:bg-gray-100" style=""><div class="rounded-t flex h-10 items-center"><span class="iconify i-catppuccin:bash ml-3" aria-hidden="true" style=""></span><!----><button ariadisabled="false" type="button" class="el-button ml-auto mr-3 rounded flex gap-1 transition-all" style=""><!--v-if--><span class=""><!--[--><span style="display:none;">Copied </span><span class="iconify i-tabler:copy" aria-hidden="true" style=""></span><!--]--></span></button></div><pre class="language-shell shiki shiki-themes github-light github-dark monokai rounded-b px-4 rounded-md whitespace-pre-wrap break-words overflow-x-auto overflow-x-auto"><!--[--><code><span class="line" line="1"><span class="srTi1">docker</span><span class="sstjo"> run</span><span class="s7F3e"> -it</span><span class="s7F3e"> --rm</span><span class="s7F3e"> --gpus</span><span class="sstjo"> all</span><span class="sstjo"> ubuntu</span><span class="sstjo"> nvidia-smi
</span></span></code><!--]-->
  </pre></div><h2 id="构建容器"><!--[-->构建容器<!--]--></h2><h3 id="编写-dockerfile"><!--[-->编写 Dockerfile<!--]--></h3><p><!--[-->将以下 <code class="px-1 rounded-b whitespace-pre-wrap break-words overflow-x-auto overflow-x-auto dark:bg-gray-700 light:bg-gray-100"><!--[-->Dockerfile<!--]--></code> 复制并根据需求进行调整。如果需要适配不同的 CUDA 版本，请参考 <a href="https://hub.docker.com/r/pytorch/pytorch/tags" rel="nofollow"><!--[-->https://hub.docker.com/r/pytorch/pytorch/tags<!--]--></a> 修改 <code class="px-1 rounded-b whitespace-pre-wrap break-words overflow-x-auto overflow-x-auto dark:bg-gray-700 light:bg-gray-100"><!--[-->FROM<!--]--></code> 部分的版本号。<!--]--></p><p><!--[-->该镜像集成了图形界面所需的依赖包，并启用了 SSH 服务。通过环境变量设置了初始密码，便于管理员批量创建容器，无需手动进入容器设置密码。<!--]--></p><div class="flex flex-col dark:bg-gray-800 light:bg-gray-100" style=""><div class="rounded-t flex h-10 items-center"><span class="iconify i-catppuccin:docker ml-3" aria-hidden="true" style=""></span><span class="ml-3">Dockerfile</span><button ariadisabled="false" type="button" class="el-button ml-auto mr-3 rounded flex gap-1 transition-all" style=""><!--v-if--><span class=""><!--[--><span style="display:none;">Copied </span><span class="iconify i-tabler:copy" aria-hidden="true" style=""></span><!--]--></span></button></div><pre class="language-dockerfile shiki shiki-themes github-light github-dark monokai rounded-b px-4 rounded-md whitespace-pre-wrap break-words overflow-x-auto overflow-x-auto"><!--[--><code><span class="line" line="1"><span class="sC2Qs">FROM</span><span class="sMOD_"> pytorch/pytorch:2.6.0-cuda12.6-cudnn9-devel
</span></span><span class="line" line="2"><span class="sC2Qs">LABEL</span><span class="sMOD_"> author=</span><span class="sstjo">&quot;li.yunhao@foxmail.com&quot;
</span></span><span class="line" line="3"><span emptylineplaceholder="true">
</span></span><span class="line" line="4"><span class="sC2Qs">ENV</span><span class="sMOD_"> PASSWORD=</span><span class="sstjo">&quot;123456&quot;
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span class="sC2Qs">RUN</span><span class="sMOD_"> ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;&amp; echo </span><span class="sstjo">&#39;Asia/Shanghai&#39;</span><span class="sMOD_"> &gt;/etc/timezone \
</span></span><span class="line" line="7"><span class="sMOD_">    &amp;&amp; conda config --set show_channel_urls yes &amp;&amp; conda init\
</span></span><span class="line" line="8"><span class="sMOD_">    &amp;&amp; apt clean &amp;&amp; apt update &amp;&amp; apt install -y --no-install-recommends sudo \
</span></span><span class="line" line="9"><span class="sMOD_">    &amp;&amp; apt install -y --no-install-recommends psmisc iputils-ping git-lfs libgl1-mesa-glx libglib2.0-0 libsm6 libxext6 libxrender-dev openssh-server git wget curl vim screen unzip build-essential cmake libncurses5-dev libncursesw5-dev pkg-config libdrm-dev libgtest-dev libudev-dev \
</span></span><span class="line" line="10"><span class="sMOD_">    &amp;&amp; sed -i -e </span><span class="sstjo">&#39;$a</span><span class="s7F3e">\P</span><span class="sstjo">ermitRootLogin yes&#39;</span><span class="sMOD_"> -e </span><span class="sstjo">&#39;$a</span><span class="s7F3e">\P</span><span class="sstjo">asswordAuthentication yes&#39;</span><span class="sMOD_"> /etc/ssh/sshd_config \
</span></span><span class="line" line="11"><span class="sMOD_">    &amp;&amp; echo </span><span class="sstjo">&quot;root:${PASSWORD}&quot;</span><span class="sMOD_"> | chpasswd \
</span></span><span class="line" line="12"><span class="sMOD_">    &amp;&amp; mkdir -p /run/sshd \
</span></span><span class="line" line="13"><span class="sMOD_">    &amp;&amp; conda init \
</span></span><span class="line" line="14"><span class="sMOD_">    &amp;&amp; apt clean
</span></span><span class="line" line="15"><span emptylineplaceholder="true">
</span></span><span class="line" line="16"><span class="s8-w5"># 安装nvtop
</span></span><span class="line" line="17"><span class="sC2Qs">RUN</span><span class="sMOD_"> git clone https://github.com/Syllo/nvtop.git /opt/nvtop \
</span></span><span class="line" line="18"><span class="sMOD_">    &amp;&amp; mkdir -p /opt/nvtop/build \
</span></span><span class="line" line="19"><span class="sMOD_">    &amp;&amp; cd /opt/nvtop/build \
</span></span><span class="line" line="20"><span class="sMOD_">    &amp;&amp; cmake .. \
</span></span><span class="line" line="21"><span class="sMOD_">    &amp;&amp; make &amp;&amp; sudo make install \
</span></span><span class="line" line="22"><span class="sMOD_">    &amp;&amp; rm -r /opt/nvtop
</span></span><span class="line" line="23"><span emptylineplaceholder="true">
</span></span><span class="line" line="24"><span class="sC2Qs">ENTRYPOINT</span><span class="sMOD_"> echo </span><span class="sstjo">&quot;root:${PASSWORD}&quot;</span><span class="sMOD_"> | chpasswd &amp;&amp; /usr/sbin/sshd -D
</span></span></code><!--]-->
  </pre></div><h3 id="build容器"><!--[-->build容器<!--]--></h3><p><!--[-->把<code class="px-1 rounded-b whitespace-pre-wrap break-words overflow-x-auto overflow-x-auto dark:bg-gray-700 light:bg-gray-100"><!--[-->Dockerfile<!--]--></code>写好之后就可以build了，可以按照希求更改build tag。<!--]--></p><div class="flex flex-col dark:bg-gray-800 light:bg-gray-100" style=""><div class="rounded-t flex h-10 items-center"><span class="iconify i-catppuccin:bash ml-3" aria-hidden="true" style=""></span><!----><button ariadisabled="false" type="button" class="el-button ml-auto mr-3 rounded flex gap-1 transition-all" style=""><!--v-if--><span class=""><!--[--><span style="display:none;">Copied </span><span class="iconify i-tabler:copy" aria-hidden="true" style=""></span><!--]--></span></button></div><pre class="language-shell shiki shiki-themes github-light github-dark monokai rounded-b px-4 rounded-md whitespace-pre-wrap break-words overflow-x-auto overflow-x-auto"><!--[--><code><span class="line" line="1"><span class="srTi1">sudo</span><span class="sstjo"> docker</span><span class="sstjo"> build</span><span class="s7F3e"> -t</span><span class="sstjo"> server/pytorch/pytorch:2.6.0-cuda12.6-cudnn9-devel</span><span class="sstjo"> .
</span></span></code><!--]-->
  </pre></div><h3 id="运行容器"><!--[-->运行容器<!--]--></h3><p><!--[-->在启动docker容器的时候要注意加一些cuda的参数<!--]--></p><ul><!--[--><li><!--[--><code class="px-1 rounded-b whitespace-pre-wrap break-words overflow-x-auto overflow-x-auto dark:bg-gray-700 light:bg-gray-100"><!--[-->-p<!--]--></code>是映射端口，我这里把<code class="px-1 rounded-b whitespace-pre-wrap break-words overflow-x-auto overflow-x-auto dark:bg-gray-700 light:bg-gray-100"><!--[-->50000<!--]--></code>端口映射出来供ssh使用<!--]--></li><li><!--[--><code class="px-1 rounded-b whitespace-pre-wrap break-words overflow-x-auto overflow-x-auto dark:bg-gray-700 light:bg-gray-100"><!--[-->--gpus all<!--]--></code>和<code class="px-1 rounded-b whitespace-pre-wrap break-words overflow-x-auto overflow-x-auto dark:bg-gray-700 light:bg-gray-100"><!--[-->-e NVIDIA_VISIBLE_DEVICES=all<!--]--></code>选择这个容器可见的显卡，如果需要控制可见显卡，可以通过<code class="px-1 rounded-b whitespace-pre-wrap break-words overflow-x-auto overflow-x-auto dark:bg-gray-700 light:bg-gray-100"><!--[-->--gpus 0,1 -e NVIDIA_VISIBLE_DEVICES=0,1<!--]--></code>指定。<!--]--></li><li><!--[--><code class="px-1 rounded-b whitespace-pre-wrap break-words overflow-x-auto overflow-x-auto dark:bg-gray-700 light:bg-gray-100"><!--[-->-e PASSWORD=&quot;your_container_password&quot;<!--]--></code>配置了容器的ssh密码<!--]--></li><!--]--></ul><div class="flex flex-col dark:bg-gray-800 light:bg-gray-100" style=""><div class="rounded-t flex h-10 items-center"><span class="iconify i-catppuccin:bash ml-3" aria-hidden="true" style=""></span><!----><button ariadisabled="false" type="button" class="el-button ml-auto mr-3 rounded flex gap-1 transition-all" style=""><!--v-if--><span class=""><!--[--><span style="display:none;">Copied </span><span class="iconify i-tabler:copy" aria-hidden="true" style=""></span><!--]--></span></button></div><pre class="language-shell shiki shiki-themes github-light github-dark monokai rounded-b px-4 rounded-md whitespace-pre-wrap break-words overflow-x-auto overflow-x-auto"><!--[--><code><span class="line" line="1"><span class="srTi1">sudo</span><span class="sstjo"> docker</span><span class="sstjo"> run</span><span class="s7F3e"> -itd</span><span class="s7F3e"> \
</span></span><span class="line" line="2"><span class="s7F3e">    -p</span><span class="sstjo"> 50000:22</span><span class="s7F3e"> --name</span><span class="sstjo"> your_container_name</span><span class="s7F3e"> \
</span></span><span class="line" line="3"><span class="s7F3e">    -e</span><span class="sstjo"> PASSWORD=&quot;your_container_password&quot;</span><span class="s7F3e"> \
</span></span><span class="line" line="4"><span class="s7F3e">    --shm-size=128g</span><span class="s7F3e"> \
</span></span><span class="line" line="5"><span class="s7F3e">    --gpus</span><span class="sstjo"> all</span><span class="s7F3e"> -e</span><span class="sstjo"> NVIDIA_VISIBLE_DEVICES=all</span><span class="s7F3e"> \
</span></span><span class="line" line="6"><span class="s7F3e">    --restart=always</span><span class="s7F3e"> \
</span></span><span class="line" line="7"><span class="sstjo">    server/pytorch/pytorch:2.6.0-cuda12.6-cudnn9-devel
</span></span></code><!--]-->
  </pre></div><p><!--[-->运行容器之后就可以愉快的ssh连进去炼丹了，再也不用担心环境搞崩影响其他人了。<!--]--></p><style>html pre.shiki code .srTi1, html code.shiki .srTi1{--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E}html pre.shiki code .sstjo, html code.shiki .sstjo{--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74}html pre.shiki code .s7F3e, html code.shiki .s7F3e{--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF}html pre.shiki code .s8-w5, html code.shiki .s8-w5{--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html pre.shiki code .sC2Qs, html code.shiki .sC2Qs{--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672}html pre.shiki code .sMOD_, html code.shiki .sMOD_{--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2}html pre.shiki code .sinWB, html code.shiki .sinWB{--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#F8F8F2}</style></div></div><!--]--><!--]--><!--]--></div><!--]--></div></div><!--[--><div class="el-scrollbar__bar is-horizontal" style="display:none;"><div class="el-scrollbar__thumb" style="width:;transform:translateX(0%);"></div></div><div class="el-scrollbar__bar is-vertical" style="display:none;"><div class="el-scrollbar__thumb" style="height:;transform:translateY(0%);"></div></div><!--]--></div><!--]--></main><!--]--></section></div></div></div></div><div id="teleports"></div><script type="application/ld+json" data-nuxt-schema-org="true" data-hid="schema-org-graph">{"@context":"https://schema.org","@graph":[{"@id":"https://yunhaoli.top/#website","@type":"WebSite","description":"Yunhao Li Blog","inLanguage":"en","name":"Yunhao Li","url":"https://yunhaoli.top/"},{"@id":"https://yunhaoli.top/blog/cuda-docker#webpage","@type":"WebPage","description":"Yunhao Li Blog","name":"Cuda Docker","url":"https://yunhaoli.top/blog/cuda-docker","isPartOf":{"@id":"https://yunhaoli.top/#website"},"potentialAction":[{"@type":"ReadAction","target":["https://yunhaoli.top/blog/cuda-docker"]}]}]}</script><script type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__">[["ShallowReactive",1],{"prerenderedAt":2,"data":3,"state":797,"once":812,"_errors":813,"serverRendered":454,"path":7,"pinia":815},1757124436326,["ShallowReactive",4],{"search":5,"/blog/cuda-docker":66},[6,11,17,23,28,33,38,42,47,52,57,62],{"id":7,"title":8,"titles":9,"content":8,"level":10},"/blog/cuda-docker","构建PyTorch Docker镜像",[],1,{"id":12,"title":13,"titles":14,"content":15,"level":16},"/blog/cuda-docker#背景","背景",[8],"实验室服务器的内核版本较旧，某个项目需要升级内核，但由于服务器上运行着大量关键服务，直接升级可能存在风险。 因此，计划通过 Docker 构建一个包含 CUDA 和 Python 环境的镜像，通过 SSH 连接到容器中进行深度学习模型训练。",2,{"id":18,"title":19,"titles":20,"content":21,"level":22},"/blog/cuda-docker#需求","需求",[8,13],"CUDA 是深度学习模型训练的核心依赖，必须包含在镜像中。此外，SSH 服务也需要配置以支持远程访问。为了简化环境管理，计划将 Python 环境及常用依赖包一并打包到镜像中。 未来，任何需要进行深度学习模型训练的用户，只需启动一个容器并映射相应端口，即可获得完整的训练环境。",3,{"id":24,"title":25,"titles":26,"content":27,"level":16},"/blog/cuda-docker#安装","安装",[8],"",{"id":29,"title":30,"titles":31,"content":32,"level":22},"/blog/cuda-docker#宿主机安装-cuda-驱动","宿主机安装 CUDA 驱动",[8,25],"以下命令用于安装 NVIDIA 驱动程序（可根据需求选择其他版本）： apt install -y nvidia-driver-550 # 可根据实际需求更换版本",{"id":34,"title":35,"titles":36,"content":37,"level":22},"/blog/cuda-docker#宿主机安装-nvidia-容器工具包","宿主机安装 NVIDIA 容器工具包",[8,25],"访问 https://nvidia.github.io/nvidia-container-runtime/ 查看支持的操作系统和版本，并根据对应的选项添加软件源。以下步骤适用于 Ubuntu 系统： curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \\\n  && curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | \\\n    sed 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' | \\\n    sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list 然后直接运行下面的命令就可以安装docker cuda驱动 sudo apt-get update\napt-get install -y nvidia-container-toolkit\ntee /etc/docker/daemon.json \u003C\u003C-'EOF'\n{\n    \"runtimes\": {\n        \"nvidia\": {\n            \"path\": \"/usr/bin/nvidia-container-runtime\",\n            \"runtimeArgs\": []\n        }\n    },\n    \"default-runtime\": \"nvidia\"\n}\nEOF\nsudo systemctl restart docker\nsudo nvidia-ctk runtime configure --runtime=containerd 进行测试，如果能成功出现显卡信息就可以了 docker run -it --rm --gpus all ubuntu nvidia-smi",{"id":39,"title":40,"titles":41,"content":27,"level":16},"/blog/cuda-docker#构建容器","构建容器",[8],{"id":43,"title":44,"titles":45,"content":46,"level":22},"/blog/cuda-docker#编写-dockerfile","编写 Dockerfile",[8,40],"将以下 Dockerfile 复制并根据需求进行调整。如果需要适配不同的 CUDA 版本，请参考 https://hub.docker.com/r/pytorch/pytorch/tags 修改 FROM 部分的版本号。 该镜像集成了图形界面所需的依赖包，并启用了 SSH 服务。通过环境变量设置了初始密码，便于管理员批量创建容器，无需手动进入容器设置密码。 FROM pytorch/pytorch:2.6.0-cuda12.6-cudnn9-devel\nLABEL author=\"li.yunhao@foxmail.com\"\n\nENV PASSWORD=\"123456\"\n\nRUN ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && echo 'Asia/Shanghai' >/etc/timezone \\\n    && conda config --set show_channel_urls yes && conda init\\\n    && apt clean && apt update && apt install -y --no-install-recommends sudo \\\n    && apt install -y --no-install-recommends psmisc iputils-ping git-lfs libgl1-mesa-glx libglib2.0-0 libsm6 libxext6 libxrender-dev openssh-server git wget curl vim screen unzip build-essential cmake libncurses5-dev libncursesw5-dev pkg-config libdrm-dev libgtest-dev libudev-dev \\\n    && sed -i -e '$a\\PermitRootLogin yes' -e '$a\\PasswordAuthentication yes' /etc/ssh/sshd_config \\\n    && echo \"root:${PASSWORD}\" | chpasswd \\\n    && mkdir -p /run/sshd \\\n    && conda init \\\n    && apt clean\n\n# 安装nvtop\nRUN git clone https://github.com/Syllo/nvtop.git /opt/nvtop \\\n    && mkdir -p /opt/nvtop/build \\\n    && cd /opt/nvtop/build \\\n    && cmake .. \\\n    && make && sudo make install \\\n    && rm -r /opt/nvtop\n\nENTRYPOINT echo \"root:${PASSWORD}\" | chpasswd && /usr/sbin/sshd -D",{"id":48,"title":49,"titles":50,"content":51,"level":22},"/blog/cuda-docker#build容器","build容器",[8,40],"把Dockerfile写好之后就可以build了，可以按照希求更改build tag。 sudo docker build -t server/pytorch/pytorch:2.6.0-cuda12.6-cudnn9-devel .",{"id":53,"title":54,"titles":55,"content":56,"level":22},"/blog/cuda-docker#运行容器","运行容器",[8,40],"在启动docker容器的时候要注意加一些cuda的参数 -p是映射端口，我这里把50000端口映射出来供ssh使用--gpus all和-e NVIDIA_VISIBLE_DEVICES=all选择这个容器可见的显卡，如果需要控制可见显卡，可以通过--gpus 0,1 -e NVIDIA_VISIBLE_DEVICES=0,1指定。-e PASSWORD=\"your_container_password\"配置了容器的ssh密码 sudo docker run -itd \\\n    -p 50000:22 --name your_container_name \\\n    -e PASSWORD=\"your_container_password\" \\\n    --shm-size=128g \\\n    --gpus all -e NVIDIA_VISIBLE_DEVICES=all \\\n    --restart=always \\\n    server/pytorch/pytorch:2.6.0-cuda12.6-cudnn9-devel 运行容器之后就可以愉快的ssh连进去炼丹了，再也不用担心环境搞崩影响其他人了。 html pre.shiki code .srTi1, html code.shiki .srTi1{--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E}html pre.shiki code .sstjo, html code.shiki .sstjo{--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74}html pre.shiki code .s7F3e, html code.shiki .s7F3e{--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF}html pre.shiki code .s8-w5, html code.shiki .s8-w5{--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html pre.shiki code .sC2Qs, html code.shiki .sC2Qs{--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672}html pre.shiki code .sMOD_, html code.shiki .sMOD_{--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2}html pre.shiki code .sinWB, html code.shiki .sinWB{--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#F8F8F2}",{"id":58,"title":59,"titles":60,"content":61,"level":10},"/blog","YunhaoLi's Blog",[],"欢迎访问我的博客！这里记录了我在深度学习以及其他领域的实践经验与心得。",{"id":63,"title":59,"titles":64,"content":65,"level":10},"/blog#yunhaolis-blog",[],"欢迎访问我的博客！这里记录了我在深度学习以及其他领域的实践经验与心得。 构建 CUDA Docker 镜像：详细介绍如何通过 Docker 构建包含 CUDA 环境的镜像，适用于深度学习模型训练。",{"id":67,"title":8,"body":68,"date":790,"description":27,"extension":791,"image":792,"meta":793,"navigation":454,"path":7,"seo":794,"stem":795,"tags":792,"__hash__":796},"blog/blog/cuda-docker.md",{"type":69,"value":70,"toc":776},"minimark",[71,77,80,83,86,89,92,95,97,100,103,135,138,148,231,234,367,370,401,403,406,422,425,620,622,628,652,654,657,691,769,772],[72,73,74],"the-title",{},[75,76,8],"p",{},[78,79,13],"h2",{"id":13},[75,81,82],{},"实验室服务器的内核版本较旧，某个项目需要升级内核，但由于服务器上运行着大量关键服务，直接升级可能存在风险。",[75,84,85],{},"因此，计划通过 Docker 构建一个包含 CUDA 和 Python 环境的镜像，通过 SSH 连接到容器中进行深度学习模型训练。",[87,88,19],"h3",{"id":19},[75,90,91],{},"CUDA 是深度学习模型训练的核心依赖，必须包含在镜像中。此外，SSH 服务也需要配置以支持远程访问。为了简化环境管理，计划将 Python 环境及常用依赖包一并打包到镜像中。",[75,93,94],{},"未来，任何需要进行深度学习模型训练的用户，只需启动一个容器并映射相应端口，即可获得完整的训练环境。",[78,96,25],{"id":25},[87,98,30],{"id":99},"宿主机安装-cuda-驱动",[75,101,102],{},"以下命令用于安装 NVIDIA 驱动程序（可根据需求选择其他版本）：",[104,105,109],"pre",{"className":106,"code":107,"language":108,"meta":27,"style":27},"language-shell shiki shiki-themes github-light github-dark monokai","apt install -y nvidia-driver-550 # 可根据实际需求更换版本\n","shell",[110,111,112],"code",{"__ignoreMap":27},[113,114,116,120,124,128,131],"span",{"class":115,"line":10},"line",[113,117,119],{"class":118},"srTi1","apt",[113,121,123],{"class":122},"sstjo"," install",[113,125,127],{"class":126},"s7F3e"," -y",[113,129,130],{"class":122}," nvidia-driver-550",[113,132,134],{"class":133},"s8-w5"," # 可根据实际需求更换版本\n",[87,136,35],{"id":137},"宿主机安装-nvidia-容器工具包",[75,139,140,141,147],{},"访问 ",[142,143,144],"a",{"href":144,"rel":145},"https://nvidia.github.io/nvidia-container-runtime/",[146],"nofollow"," 查看支持的操作系统和版本，并根据对应的选项添加软件源。以下步骤适用于 Ubuntu 系统：",[104,149,151],{"className":106,"code":150,"language":108,"meta":27,"style":27},"curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \\\n  && curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | \\\n    sed 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' | \\\n    sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list\n",[110,152,153,186,207,219],{"__ignoreMap":27},[113,154,155,158,161,164,168,171,174,177,180,183],{"class":115,"line":10},[113,156,157],{"class":118},"curl",[113,159,160],{"class":126}," -fsSL",[113,162,163],{"class":122}," https://nvidia.github.io/libnvidia-container/gpgkey",[113,165,167],{"class":166},"sC2Qs"," |",[113,169,170],{"class":118}," sudo",[113,172,173],{"class":122}," gpg",[113,175,176],{"class":126}," --dearmor",[113,178,179],{"class":126}," -o",[113,181,182],{"class":122}," /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg",[113,184,185],{"class":126}," \\\n",[113,187,188,192,194,197,200,203,205],{"class":115,"line":16},[113,189,191],{"class":190},"sMOD_","  && ",[113,193,157],{"class":118},[113,195,196],{"class":126}," -s",[113,198,199],{"class":126}," -L",[113,201,202],{"class":122}," https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list",[113,204,167],{"class":166},[113,206,185],{"class":126},[113,208,209,212,215,217],{"class":115,"line":22},[113,210,211],{"class":118},"    sed",[113,213,214],{"class":122}," 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g'",[113,216,167],{"class":166},[113,218,185],{"class":126},[113,220,222,225,228],{"class":115,"line":221},4,[113,223,224],{"class":118},"    sudo",[113,226,227],{"class":122}," tee",[113,229,230],{"class":122}," /etc/apt/sources.list.d/nvidia-container-toolkit.list\n",[75,232,233],{},"然后直接运行下面的命令就可以安装docker cuda驱动",[104,235,237],{"className":106,"code":236,"language":108,"meta":27,"style":27},"sudo apt-get update\napt-get install -y nvidia-container-toolkit\ntee /etc/docker/daemon.json \u003C\u003C-'EOF'\n{\n    \"runtimes\": {\n        \"nvidia\": {\n            \"path\": \"/usr/bin/nvidia-container-runtime\",\n            \"runtimeArgs\": []\n        }\n    },\n    \"default-runtime\": \"nvidia\"\n}\nEOF\nsudo systemctl restart docker\nsudo nvidia-ctk runtime configure --runtime=containerd\n",[110,238,239,250,262,277,282,288,294,300,306,312,318,324,330,336,350],{"__ignoreMap":27},[113,240,241,244,247],{"class":115,"line":10},[113,242,243],{"class":118},"sudo",[113,245,246],{"class":122}," apt-get",[113,248,249],{"class":122}," update\n",[113,251,252,255,257,259],{"class":115,"line":16},[113,253,254],{"class":118},"apt-get",[113,256,123],{"class":122},[113,258,127],{"class":126},[113,260,261],{"class":122}," nvidia-container-toolkit\n",[113,263,264,267,270,273],{"class":115,"line":22},[113,265,266],{"class":118},"tee",[113,268,269],{"class":122}," /etc/docker/daemon.json",[113,271,272],{"class":166}," \u003C\u003C-",[113,274,276],{"class":275},"sinWB","'EOF'\n",[113,278,279],{"class":115,"line":221},[113,280,281],{"class":122},"{\n",[113,283,285],{"class":115,"line":284},5,[113,286,287],{"class":122},"    \"runtimes\": {\n",[113,289,291],{"class":115,"line":290},6,[113,292,293],{"class":122},"        \"nvidia\": {\n",[113,295,297],{"class":115,"line":296},7,[113,298,299],{"class":122},"            \"path\": \"/usr/bin/nvidia-container-runtime\",\n",[113,301,303],{"class":115,"line":302},8,[113,304,305],{"class":122},"            \"runtimeArgs\": []\n",[113,307,309],{"class":115,"line":308},9,[113,310,311],{"class":122},"        }\n",[113,313,315],{"class":115,"line":314},10,[113,316,317],{"class":122},"    },\n",[113,319,321],{"class":115,"line":320},11,[113,322,323],{"class":122},"    \"default-runtime\": \"nvidia\"\n",[113,325,327],{"class":115,"line":326},12,[113,328,329],{"class":122},"}\n",[113,331,333],{"class":115,"line":332},13,[113,334,335],{"class":275},"EOF\n",[113,337,339,341,344,347],{"class":115,"line":338},14,[113,340,243],{"class":118},[113,342,343],{"class":122}," systemctl",[113,345,346],{"class":122}," restart",[113,348,349],{"class":122}," docker\n",[113,351,353,355,358,361,364],{"class":115,"line":352},15,[113,354,243],{"class":118},[113,356,357],{"class":122}," nvidia-ctk",[113,359,360],{"class":122}," runtime",[113,362,363],{"class":122}," configure",[113,365,366],{"class":126}," --runtime=containerd\n",[75,368,369],{},"进行测试，如果能成功出现显卡信息就可以了",[104,371,373],{"className":106,"code":372,"language":108,"meta":27,"style":27},"docker run -it --rm --gpus all ubuntu nvidia-smi\n",[110,374,375],{"__ignoreMap":27},[113,376,377,380,383,386,389,392,395,398],{"class":115,"line":10},[113,378,379],{"class":118},"docker",[113,381,382],{"class":122}," run",[113,384,385],{"class":126}," -it",[113,387,388],{"class":126}," --rm",[113,390,391],{"class":126}," --gpus",[113,393,394],{"class":122}," all",[113,396,397],{"class":122}," ubuntu",[113,399,400],{"class":122}," nvidia-smi\n",[78,402,40],{"id":40},[87,404,44],{"id":405},"编写-dockerfile",[75,407,408,409,412,413,417,418,421],{},"将以下 ",[110,410,411],{},"Dockerfile"," 复制并根据需求进行调整。如果需要适配不同的 CUDA 版本，请参考 ",[142,414,415],{"href":415,"rel":416},"https://hub.docker.com/r/pytorch/pytorch/tags",[146]," 修改 ",[110,419,420],{},"FROM"," 部分的版本号。",[75,423,424],{},"该镜像集成了图形界面所需的依赖包，并启用了 SSH 服务。通过环境变量设置了初始密码，便于管理员批量创建容器，无需手动进入容器设置密码。",[104,426,430],{"className":427,"code":428,"filename":411,"language":429,"meta":27,"style":27},"language-dockerfile shiki shiki-themes github-light github-dark monokai","FROM pytorch/pytorch:2.6.0-cuda12.6-cudnn9-devel\nLABEL author=\"li.yunhao@foxmail.com\"\n\nENV PASSWORD=\"123456\"\n\nRUN ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && echo 'Asia/Shanghai' >/etc/timezone \\\n    && conda config --set show_channel_urls yes && conda init\\\n    && apt clean && apt update && apt install -y --no-install-recommends sudo \\\n    && apt install -y --no-install-recommends psmisc iputils-ping git-lfs libgl1-mesa-glx libglib2.0-0 libsm6 libxext6 libxrender-dev openssh-server git wget curl vim screen unzip build-essential cmake libncurses5-dev libncursesw5-dev pkg-config libdrm-dev libgtest-dev libudev-dev \\\n    && sed -i -e '$a\\PermitRootLogin yes' -e '$a\\PasswordAuthentication yes' /etc/ssh/sshd_config \\\n    && echo \"root:${PASSWORD}\" | chpasswd \\\n    && mkdir -p /run/sshd \\\n    && conda init \\\n    && apt clean\n\n# 安装nvtop\nRUN git clone https://github.com/Syllo/nvtop.git /opt/nvtop \\\n    && mkdir -p /opt/nvtop/build \\\n    && cd /opt/nvtop/build \\\n    && cmake .. \\\n    && make && sudo make install \\\n    && rm -r /opt/nvtop\n\nENTRYPOINT echo \"root:${PASSWORD}\" | chpasswd && /usr/sbin/sshd -D\n\n","dockerfile",[110,431,432,439,450,456,467,471,485,490,495,500,527,538,543,548,553,557,563,571,577,583,589,595,601,606],{"__ignoreMap":27},[113,433,434,436],{"class":115,"line":10},[113,435,420],{"class":166},[113,437,438],{"class":190}," pytorch/pytorch:2.6.0-cuda12.6-cudnn9-devel\n",[113,440,441,444,447],{"class":115,"line":16},[113,442,443],{"class":166},"LABEL",[113,445,446],{"class":190}," author=",[113,448,449],{"class":122},"\"li.yunhao@foxmail.com\"\n",[113,451,452],{"class":115,"line":22},[113,453,455],{"emptyLinePlaceholder":454},true,"\n",[113,457,458,461,464],{"class":115,"line":221},[113,459,460],{"class":166},"ENV",[113,462,463],{"class":190}," PASSWORD=",[113,465,466],{"class":122},"\"123456\"\n",[113,468,469],{"class":115,"line":284},[113,470,455],{"emptyLinePlaceholder":454},[113,472,473,476,479,482],{"class":115,"line":290},[113,474,475],{"class":166},"RUN",[113,477,478],{"class":190}," ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && echo ",[113,480,481],{"class":122},"'Asia/Shanghai'",[113,483,484],{"class":190}," >/etc/timezone \\\n",[113,486,487],{"class":115,"line":296},[113,488,489],{"class":190},"    && conda config --set show_channel_urls yes && conda init\\\n",[113,491,492],{"class":115,"line":302},[113,493,494],{"class":190},"    && apt clean && apt update && apt install -y --no-install-recommends sudo \\\n",[113,496,497],{"class":115,"line":308},[113,498,499],{"class":190},"    && apt install -y --no-install-recommends psmisc iputils-ping git-lfs libgl1-mesa-glx libglib2.0-0 libsm6 libxext6 libxrender-dev openssh-server git wget curl vim screen unzip build-essential cmake libncurses5-dev libncursesw5-dev pkg-config libdrm-dev libgtest-dev libudev-dev \\\n",[113,501,502,505,508,511,514,517,519,521,524],{"class":115,"line":314},[113,503,504],{"class":190},"    && sed -i -e ",[113,506,507],{"class":122},"'$a",[113,509,510],{"class":126},"\\P",[113,512,513],{"class":122},"ermitRootLogin yes'",[113,515,516],{"class":190}," -e ",[113,518,507],{"class":122},[113,520,510],{"class":126},[113,522,523],{"class":122},"asswordAuthentication yes'",[113,525,526],{"class":190}," /etc/ssh/sshd_config \\\n",[113,528,529,532,535],{"class":115,"line":320},[113,530,531],{"class":190},"    && echo ",[113,533,534],{"class":122},"\"root:${PASSWORD}\"",[113,536,537],{"class":190}," | chpasswd \\\n",[113,539,540],{"class":115,"line":326},[113,541,542],{"class":190},"    && mkdir -p /run/sshd \\\n",[113,544,545],{"class":115,"line":332},[113,546,547],{"class":190},"    && conda init \\\n",[113,549,550],{"class":115,"line":338},[113,551,552],{"class":190},"    && apt clean\n",[113,554,555],{"class":115,"line":352},[113,556,455],{"emptyLinePlaceholder":454},[113,558,560],{"class":115,"line":559},16,[113,561,562],{"class":133},"# 安装nvtop\n",[113,564,566,568],{"class":115,"line":565},17,[113,567,475],{"class":166},[113,569,570],{"class":190}," git clone https://github.com/Syllo/nvtop.git /opt/nvtop \\\n",[113,572,574],{"class":115,"line":573},18,[113,575,576],{"class":190},"    && mkdir -p /opt/nvtop/build \\\n",[113,578,580],{"class":115,"line":579},19,[113,581,582],{"class":190},"    && cd /opt/nvtop/build \\\n",[113,584,586],{"class":115,"line":585},20,[113,587,588],{"class":190},"    && cmake .. \\\n",[113,590,592],{"class":115,"line":591},21,[113,593,594],{"class":190},"    && make && sudo make install \\\n",[113,596,598],{"class":115,"line":597},22,[113,599,600],{"class":190},"    && rm -r /opt/nvtop\n",[113,602,604],{"class":115,"line":603},23,[113,605,455],{"emptyLinePlaceholder":454},[113,607,609,612,615,617],{"class":115,"line":608},24,[113,610,611],{"class":166},"ENTRYPOINT",[113,613,614],{"class":190}," echo ",[113,616,534],{"class":122},[113,618,619],{"class":190}," | chpasswd && /usr/sbin/sshd -D\n",[87,621,49],{"id":49},[75,623,624,625,627],{},"把",[110,626,411],{},"写好之后就可以build了，可以按照希求更改build tag。",[104,629,631],{"className":106,"code":630,"language":108,"meta":27,"style":27},"sudo docker build -t server/pytorch/pytorch:2.6.0-cuda12.6-cudnn9-devel .\n",[110,632,633],{"__ignoreMap":27},[113,634,635,637,640,643,646,649],{"class":115,"line":10},[113,636,243],{"class":118},[113,638,639],{"class":122}," docker",[113,641,642],{"class":122}," build",[113,644,645],{"class":126}," -t",[113,647,648],{"class":122}," server/pytorch/pytorch:2.6.0-cuda12.6-cudnn9-devel",[113,650,651],{"class":122}," .\n",[87,653,54],{"id":54},[75,655,656],{},"在启动docker容器的时候要注意加一些cuda的参数",[658,659,660,671,685],"ul",{},[661,662,663,666,667,670],"li",{},[110,664,665],{},"-p","是映射端口，我这里把",[110,668,669],{},"50000","端口映射出来供ssh使用",[661,672,673,676,677,680,681,684],{},[110,674,675],{},"--gpus all","和",[110,678,679],{},"-e NVIDIA_VISIBLE_DEVICES=all","选择这个容器可见的显卡，如果需要控制可见显卡，可以通过",[110,682,683],{},"--gpus 0,1 -e NVIDIA_VISIBLE_DEVICES=0,1","指定。",[661,686,687,690],{},[110,688,689],{},"-e PASSWORD=\"your_container_password\"","配置了容器的ssh密码",[104,692,694],{"className":106,"code":693,"language":108,"meta":27,"style":27},"sudo docker run -itd \\\n    -p 50000:22 --name your_container_name \\\n    -e PASSWORD=\"your_container_password\" \\\n    --shm-size=128g \\\n    --gpus all -e NVIDIA_VISIBLE_DEVICES=all \\\n    --restart=always \\\n    server/pytorch/pytorch:2.6.0-cuda12.6-cudnn9-devel\n",[110,695,696,709,725,735,742,757,764],{"__ignoreMap":27},[113,697,698,700,702,704,707],{"class":115,"line":10},[113,699,243],{"class":118},[113,701,639],{"class":122},[113,703,382],{"class":122},[113,705,706],{"class":126}," -itd",[113,708,185],{"class":126},[113,710,711,714,717,720,723],{"class":115,"line":16},[113,712,713],{"class":126},"    -p",[113,715,716],{"class":122}," 50000:22",[113,718,719],{"class":126}," --name",[113,721,722],{"class":122}," your_container_name",[113,724,185],{"class":126},[113,726,727,730,733],{"class":115,"line":22},[113,728,729],{"class":126},"    -e",[113,731,732],{"class":122}," PASSWORD=\"your_container_password\"",[113,734,185],{"class":126},[113,736,737,740],{"class":115,"line":221},[113,738,739],{"class":126},"    --shm-size=128g",[113,741,185],{"class":126},[113,743,744,747,749,752,755],{"class":115,"line":284},[113,745,746],{"class":126},"    --gpus",[113,748,394],{"class":122},[113,750,751],{"class":126}," -e",[113,753,754],{"class":122}," NVIDIA_VISIBLE_DEVICES=all",[113,756,185],{"class":126},[113,758,759,762],{"class":115,"line":290},[113,760,761],{"class":126},"    --restart=always",[113,763,185],{"class":126},[113,765,766],{"class":115,"line":296},[113,767,768],{"class":122},"    server/pytorch/pytorch:2.6.0-cuda12.6-cudnn9-devel\n",[75,770,771],{},"运行容器之后就可以愉快的ssh连进去炼丹了，再也不用担心环境搞崩影响其他人了。",[773,774,775],"style",{},"html pre.shiki code .srTi1, html code.shiki .srTi1{--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E}html pre.shiki code .sstjo, html code.shiki .sstjo{--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74}html pre.shiki code .s7F3e, html code.shiki .s7F3e{--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF}html pre.shiki code .s8-w5, html code.shiki .s8-w5{--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html pre.shiki code .sC2Qs, html code.shiki .sC2Qs{--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672}html pre.shiki code .sMOD_, html code.shiki .sMOD_{--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2}html pre.shiki code .sinWB, html code.shiki .sinWB{--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#F8F8F2}",{"title":27,"searchDepth":22,"depth":22,"links":777},[778,781,785],{"id":13,"depth":16,"text":13,"children":779},[780],{"id":19,"depth":22,"text":19},{"id":25,"depth":16,"text":25,"children":782},[783,784],{"id":99,"depth":22,"text":30},{"id":137,"depth":22,"text":35},{"id":40,"depth":16,"text":40,"children":786},[787,788,789],{"id":405,"depth":22,"text":44},{"id":49,"depth":22,"text":49},{"id":54,"depth":22,"text":54},"2025-02-24T00:00:00.000Z","md",null,{},{"title":8,"description":27},"blog/cuda-docker","OnmfU1WADlauz0yB6vJxzItLRHWWNmR3vR1aWG_vtTU",["Reactive",798],{"$scolor-mode":799,"$snuxt-seo-utils:routeRules":802,"$ssite-config":803},{"preference":800,"value":800,"unknown":454,"forced":801},"system",false,{"head":-1,"seoMeta":-1},{"_priority":804,"description":808,"env":809,"name":810,"url":811},{"name":805,"env":806,"description":807,"url":805},-3,-15,-10,"Yunhao Li Blog","production","Yunhao Li","https://yunhaoli.top",["Set"],["ShallowReactive",814],{"search":-1,"/blog/cuda-docker":-1},{}]</script><script>window.__NUXT__={};window.__NUXT__.config={public:{"seo-utils":{canonicalQueryWhitelist:["page","sort","filter","search","q","category","tag"],canonicalLowercase:true},device:{defaultUserAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.39 Safari/537.36",enabled:true,refreshOnResize:false},content:{wsUrl:""},mdc:{components:{prose:true,map:{}},headings:{anchorLinks:{h1:false,h2:false,h3:false,h4:false,h5:false,h6:false}}}},app:{baseURL:"/",buildId:"bb85fc13-cd4e-4b6a-a07d-f81f8017cc1b",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>